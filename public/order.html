<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>注文ページ - ロマンス農園</title>
  
  <!-- Preload critical CSS -->
  <link rel="preload" href="css/style.css" as="style">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/multiple-shipping.css">
  <link rel="stylesheet" href="css/order.css">
  
  <!-- Defer non-critical CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" media="print" onload="this.media='all'">
  
  <!-- Fallback for browsers that don't support onload -->
  <noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  </noscript>
</head>
<body>
  <header>
    <div class="container">
      <div class="logo">
        <h1><a href="/">ロマンス農園</a></h1>
      </div>
      <nav>
        <ul class="nav-links">
          <li><a href="/">ホーム</a></li>
          <li><a href="/">商品一覧</a></li>
          <li><a href="/order.html" class="active">注文</a></li>
          <li><a href="/">アカウント</a></li>
        </ul>
      </nav>
      <div class="user-actions">
        <div class="auth-buttons">
          <button id="login-btn" class="btn">ログイン</button>
          <button id="register-btn" class="btn btn-primary">登録</button>
        </div>
        <div class="user-profile hidden">
          <span class="user-name">ユーザー名</span>
          <button id="logout-btn" class="btn">ログアウト</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <section id="order-page">
        <h2>注文ページ</h2>
        
        <div class="order-container">
          <!-- Shipping Destinations -->
          <div class="shipping-destinations">
            <h3>お届け先</h3>
            <div id="shipping-destinations-container">
              <!-- Shipping destinations will be added here dynamically -->
              <div class="shipping-destination" data-destination-id="1">
                <div class="destination-header">
                  <h4>お届け先 #1</h4>
                </div>
                <div class="destination-form">
                  <div class="form-group name-group">
                    <label for="name-1">お名前</label>
                    <div class="name-input-container">
                      <input type="text" id="name-1" name="name-1" required>
                      <span class="name-suffix">様</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="postal-1">郵便番号</label>
                    <input type="text" id="postal-1" name="postal-1" required placeholder="例: 123-4567">
                  </div>
                  <div class="form-group">
                    <label for="prefecture-1">都道府県</label>
                    <input type="text" id="prefecture-1" name="prefecture-1" required>
                  </div>
                  <div class="form-group">
                    <label for="address-1">住所</label>
                    <input type="text" id="address-1" name="address-1" required>
                  </div>
                  <div class="form-group">
                    <label for="phone-1">電話番号</label>
                    <input type="tel" id="phone-1" name="phone-1" required>
                  </div>
                </div>
                
                <div class="destination-products">
                  <h4>商品選択</h4>
                  <div class="product-selection-container" id="product-selection-1">
                    <!-- Products will be loaded here dynamically -->
                    <div class="loading-products">商品を読み込み中...</div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="add-destination-container">
              <button id="add-destination-btn" class="btn">
                <i class="fas fa-plus"></i> 送り先を追加する
              </button>
            </div>
          </div>
          
          <!-- Order Summary -->
          <div class="order-summary">
            <h3>注文内容</h3>
            <div id="order-summary-container">
              <!-- Order summary will be added here dynamically -->
              <div class="summary-loading">注文内容を計算中...</div>
            </div>
            
            <div class="order-actions">
              <button id="back-to-products-btn" class="btn">商品一覧に戻る</button>
              <button id="confirm-order-btn" class="btn btn-primary">注文を確定する</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Modals -->
  <div class="modal" id="login-modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>ログイン</h2>
      <form id="login-form">
        <div class="form-group">
          <label for="login-email">メールアドレス</label>
          <input type="email" id="login-email" name="email" required>
        </div>
        <div class="form-group">
          <label for="login-password">パスワード</label>
          <input type="password" id="login-password" name="password" required>
        </div>
        <button type="submit" class="btn btn-primary">ログイン</button>
      </form>
      <div class="social-login">
        <p>または</p>
        <button type="button" id="google-login-btn" class="btn btn-google">
          <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google logo" width="18" height="18">
          Googleでログイン
        </button>
      </div>
      <p class="form-switch">アカウントをお持ちでない方は <a href="#" id="switch-to-register">登録</a></p>
    </div>
  </div>

  <div class="modal" id="register-modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>アカウント登録</h2>
      <form id="register-form">
        <div class="form-group">
          <label for="register-name">名前</label>
          <input type="text" id="register-name" name="name" required>
        </div>
        <div class="form-group">
          <label for="register-email">メールアドレス</label>
          <input type="email" id="register-email" name="email" required>
        </div>
        <div class="form-group">
          <label for="register-password">パスワード</label>
          <input type="password" id="register-password" name="password" required>
        </div>
        <div class="form-group">
          <label for="register-password-confirm">パスワード（確認）</label>
          <input type="password" id="register-password-confirm" name="passwordConfirm" required>
        </div>
        <button type="submit" class="btn btn-primary">登録</button>
      </form>
      <p class="form-switch">すでにアカウントをお持ちの方は <a href="#" id="switch-to-login">ログイン</a></p>
    </div>
  </div>

  <div class="modal" id="order-confirmation-modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>注文確認</h2>
      <div id="order-confirmation-content">
        <!-- Order confirmation content will be added here dynamically -->
      </div>
      <div class="confirmation-actions">
        <button id="edit-order-btn" class="btn">注文を編集する</button>
        <button id="place-order-btn" class="btn btn-primary">注文を確定する</button>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>ロマンス農園</h3>
          <p>苫小牧から新鮮なアスパラをお届け</p>
        </div>
        <div class="footer-section">
          <h3>リンク</h3>
          <ul>
            <li><a href="/">ホーム</a></li>
            <li><a href="/">商品一覧</a></li>
            <li><a href="/order.html">注文方法</a></li>
            <li><a href="/">お問い合わせ</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>お問い合わせ</h3>
          <p>住所　: 北海道苫小牧市樽前90</p>
          <p>メール: info@farm-direct.jp</p>
          <p>電話　: 03-1234-5678</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 RomanceFarm. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Core scripts needed for initial page load -->
  <script src="js/api.js"></script>
  
  <!-- Load the auth module -->
  <script src="js/auth.js"></script>
  
  <!-- Order page specific scripts -->
  <script src="js/order.js"></script>
  
  <!-- Debug authentication script (only in development) -->
  <!-- <script src="js/auth-debug.js"></script> -->
</body>
</html>
